import React from 'react'
import {Link} from 'react-router'
import {connect} from 'react-redux'

import {
    getTotalBasketCount,
    getTotalBasketPrice,
    getBasketPizzaWithoutCount
} from 'selectors'

import {removePizzaFromBasketByIndex} from 'actions'



const BasketCart = ( { pizza, totalBasketCount, totalPrice,removePizzaFromBasketByIndex}) => (
    <div>
        <h3>Корзина</h3>
        <div className="cart">
            <div className="panel panel-default">
                <div className="panel-body">
                    {totalPrice > 0 &&
                    <div className="cart__body">
                        {
                            pizza.map((item, index) => (
                                <div className="cart-item" key={index}>
                                    <div>
                                        <button className="btn btn-danger btn-xs" onClick={() => removePizzaFromBasketByIndex(index)}>X</button>
                                        <span className="cart-item__name">{item.name}</span>
                                    </div>
                                    <div className="cart-item__price">{item.price} руб.</div>
                                </div>
                            ))}
                    </div>
                    }
                    {totalPrice === 0 && (
                        <div className="alert alert-success">Корзина пуста</div>
                    )}
                    {totalPrice > 0 && (
                        <div className="cart__total">
                            <Link
                                to='/basket'>
                                <span style= {{color: 'green'}}> Сумма: {totalPrice} руб.</span>
                                </Link>
                        </div>
                    )}

                </div>
            </div>
        </div>
    </div>

)

const mapDispatchToProps = {
    removePizzaFromBasketByIndex
}

const mapStateToProps = state => ({
    totalBasketCount : getTotalBasketCount(state),
    totalPrice : getTotalBasketPrice(state),
    pizza: getBasketPizzaWithoutCount(state)
})

export default connect(mapStateToProps, mapDispatchToProps) (BasketCart)
